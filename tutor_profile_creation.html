<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutor Dashboard</title>
    <style>
        /* Basic styles for the navigation menu */
        nav {
            background-color: #333;
            overflow: hidden;
        }
        nav a {
            float: left;
            display: block;
            color: white;
            text-align: center;
            padding: 14px 20px;
            text-decoration: none;
        }
        nav a:hover {
            background-color: #ddd;
            color: black;
        }
        /* Styles for the form */
        form {
            margin: 20px;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .form-section {
            margin-bottom: 40px;
            display: none; /* Hide all sections initially */
        }
        .alert-message {
            color: red;
        }
    </style>
</head>
<body>

    <!-- Header Section -->
    <header>
        <h1>Welcome, Tutor!</h1>

        <!-- Navigation Menu -->
        <nav>
            <a href="#about">About</a>
            <a href="#education">Education</a>
            <a href="#description">Description</a>
            <a href="#availability-pricing">Availability & Pricing</a>
        </nav>
    </header>

    <!-- About Section -->
    <section id="about" class="form-section" style="display: block;">
        <h2>About You</h2>
        <form id="about-form">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" required>

            <label for="roll-number">Registered Roll Number</label>
            <input type="text" id="roll-number" name="roll_number" required>

            <label for="country">Country</label>
            <input type="text" id="country" name="country" required>

            <label for="city">City</label>
            <input type="text" id="city" name="city" required>

            <label for="languages">Languages (Enter multiple, separated by commas)</label>
            <input type="text" id="languages" name="languages" placeholder="e.g., English, Spanish, French" required>

            <button type="button" onclick="nextSection('about', 'education')">Next</button>
        </form>
    </section>

    <!-- Education Section -->
    <section id="education" class="form-section">
        <h2>Education</h2>
        <form id="education-form">
            <label for="university">University/College</label>
            <input type="text" id="university" name="university" required>

            <label for="degree-name">Degree Name</label>
            <input type="text" id="degree-name" name="degree_name" required>

            <label for="degree-type">Degree Type</label>
            <input type="text" id="degree-type" name="degree_type" required>

            <label for="specialization">Specialization</label>
            <input type="text" id="specialization" name="specialization" required>

            <!-- Start Year Dropdown -->
            <label for="start-year">Starting Year</label>
            <select id="start-year" name="start_year" required>
                <option value="" disabled selected>Select Year</option>
                <script>
                    const startYearSelect = document.getElementById('start-year');
                    const currentYear = new Date().getFullYear();
                    for (let i = currentYear; i >= 1900; i--) {
                        const option = document.createElement('option');
                        option.value = i;
                        option.text = i;
                        startYearSelect.appendChild(option);
                    }
                </script>
            </select>

            <!-- End Year Dropdown -->
            <label for="end-year">Ending Year</label>
            <select id="end-year" name="end_year" required>
                <option value="" disabled selected>Select Year</option>
                <script>
                    const endYearSelect = document.getElementById('end-year');
                    for (let i = currentYear; i >= 1900; i--) {
                        const option = document.createElement('option');
                        option.value = i;
                        option.text = i;
                        endYearSelect.appendChild(option);
                    }
                </script>
            </select>

            <label for="degree-upload">Upload Degree</label>
            <input type="file" id="degree-upload" name="degree_upload" accept=".pdf, .jpg, .jpeg, .png" required>

            <button type="button" onclick="nextSection('education', 'description')">Next</button>
            <button type="button" onclick="previousSection('education', 'about')">Previous</button>
        </form>
    </section>

    <!-- Description Section -->
    <section id="description" class="form-section">
        <h2>Description</h2>
        <form id="description-form">
            <label for="subject">Subject You Teach</label>
            <input type="text" id="subject" name="subject" required>

            <label for="grade">Grade of Students You Teach</label>
            <input type="text" id="grade" name="grade" required>


            <label for="session-type">Session type</label>
            <select id="session-type" name="session_type" required>
                <option value="" disabled selected>Select Prefered Type of Session</option>
                <option value="One to one Session">One on One Session</option>
                <option value="Group Session">Group Session</option>
            </select>

            <label for="self-introduction">Self Introduction (250 words)</label>
            <textarea id="self-introduction" name="self_introduction" maxlength="1000" placeholder="Tell us about yourself in 250 words" required></textarea>
            <div class="alert-message">
                <small>Max 250 words</small>
            </div>

            <label for="teaching-experience">Teaching Experience (250 words)</label>
            <textarea id="teaching-experience" name="teaching_experience" maxlength="1000" placeholder="Describe your teaching experience in 250 words" required></textarea>
            <div class="alert-message">
                <small>Max 250 words</small>
            </div>

            <button type="button" onclick="nextSection('description', 'availability-pricing')">Next</button>
            <button type="button" onclick="previousSection('description', 'education')">Previous</button>
        </form>
    </section>

    <!-- Availability & Pricing Section -->
    <section id="availability-pricing" class="form-section">
        <h2>Availability & Pricing</h2>
        <form id="availability-pricing-form">
            <label for="teaching-fee">Expected Teaching Fee (per hour)</label>
            <input type="number" id="teaching-fee" name="teaching_fee" step="0.01" required>

            <label for="availability-days">Availability Days (Comma separated)</label>
            <input type="text" id="availability-days" name="availability_days" placeholder="e.g., Monday, Wednesday, Friday" required>

            <label for="availability-time">Availability Time</label>
            <select id="availability-time" name="availability_time" required>
                <option value="" disabled selected>Select Time</option>
                <option value="morning">Morning</option>
                <option value="afternoon">Afternoon</option>
                <option value="evening">Evening</option>
                <option value="midnight">Midnight</option>
                <option value="anytime">Anytime</option>
            </select>

            <button type="button" onclick="submitForm(event)">Submit</button>
            <button type="button" onclick="previousSection('availability-pricing', 'description')">Previous</button>
        </form>
    </section>

    <script>

        alert("You haven't created your profile yet. Please build your profile");
        let degreeUploadName = '';

        document.getElementById('degree-upload').addEventListener('change', function (event) {
            const file = event.target.files[0];
            if (file) {
                degreeUploadName = file.name;
            }
        });

        function submitForm(event) {
            event.preventDefault();
    
            const formData = new FormData();
            formData.append('email', document.getElementById('email').value);
            formData.append('roll_number', document.getElementById('roll-number').value);
            formData.append('country', document.getElementById('country').value);
            formData.append('city', document.getElementById('city').value);
            formData.append('languages', document.getElementById('languages').value);
            formData.append('university', document.getElementById('university').value);
            formData.append('degree_name', document.getElementById('degree-name').value);
            formData.append('degree_type', document.getElementById('degree-type').value);
            formData.append('specialization', document.getElementById('specialization').value);
            formData.append('start_year', document.getElementById('start-year').value);
            formData.append('end_year', document.getElementById('end-year').value);
            formData.append('subject', document.getElementById('subject').value);
            formData.append('grade', document.getElementById('grade').value);
            formData.append('session_type', document.getElementById('session-type').value);
            formData.append('self_introduction', document.getElementById('self-introduction').value);
            formData.append('teaching_experience', document.getElementById('teaching-experience').value);
            formData.append('teaching_fee', document.getElementById('teaching-fee').value);
            formData.append('availability_days', document.getElementById('availability-days').value);
            formData.append('availability_time', document.getElementById('availability-time').value);
    
            // Append the file
            const degreeFile = document.getElementById('degree-upload').files[0];
            if (degreeFile) {
                formData.append('degree_upload', degreeFile);
            }
    
            fetch('/api/tutor_profile_creation', {
                method: 'POST',
                body: formData // Send as FormData
            })
            .then(response => response.json())
            .then(data => {
                if (data.redirect) {
                    window.location.href = data.redirect;
                } else {
                    alert(data.message);
                }
            })
            .catch(error => console.error('Error:', error));
        }
    
        function nextSection(currentSectionId, nextSectionId) {
            document.getElementById(currentSectionId).style.display = "none";
            document.getElementById(nextSectionId).style.display = "block";
        }

        function previousSection(currentSectionId, previousSectionId) {
            document.getElementById(currentSectionId).style.display = "none";
            document.getElementById(previousSectionId).style.display = "block";
        }
    </script>

</body>
</html>
